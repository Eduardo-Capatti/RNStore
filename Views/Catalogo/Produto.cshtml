
@model RNStore.Models.Catalogo

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="~/css/produto.css" asp-append-version="true">
    <script src="https://kit.fontawesome.com/4550765f78.js" crossorigin="anonymous"></script>
</head>


<script>
    function acessarProduto(idProduto, calcadoId) {
        window.location.href = "/Catalogo/Produto/" + idProduto + "/" + calcadoId
    }
</script>

<body class="bg-light">

    @await Html.PartialAsync("_Menu")

    <!--Conteúdo da página-->
    <div class="container" style="flex:1">

        @{
            var i = 0; 
        }

        <div class="row" style="margin-top: 100px;">
            <div class="col-sm-5 col-md-5 col-lg-7  text-center">
                @{foreach (var img in Model.img){
                    if(i < 1){
                        <div class="text-center d-inline-block" id="foto-principal-produto">
                            <img id="img-principal" width="300px" class="img-fluid" src="~/img/produtos/@img.nomeImagem">
                        </div>
                        i++;
                    }else{
                        break;
                    }
                }
                    i = 0;
                }
               
                <div>
        
                    @{foreach (var img in Model.img){
                        

                        if (i == 0){
                            <div id="@img.nomeImagem" class="mt-4 text-center d-inline-block foto-secundaria-produto" style="border: 2px solid #1E90FF;" onclick="trocarImgPrincipal('@img.nomeImagem')">
                                <img width="100px" class="img-fluid" src="~/img/produtos/@img.nomeImagem" >
                            </div>
                            i++;
                        }else{
                            <div id="@img.nomeImagem" class="mt-4 text-center d-inline-block foto-secundaria-produto" onclick="trocarImgPrincipal('@img.nomeImagem')">
                                <img class="img-fluid" src="~/img/produtos/@img.nomeImagem" >
                            </div>
                        }
                        
                    }

                    i = 0;
                    }
                </div>

            </div>

            <div class="col-sm-7 col-md-7 col-lg-5 ">

                <div class="ms-5 mt-5 mt-sm-0 produto-conteudo">
                    <h3>@Model.nomeCalcado</h3>
                    @if(@Model.promocao > 0){
                        decimal novoPreco = Model.preco - (Model.promocao ?? 0);
                        <h3 class="mt-4 mb-0"><sup><s>R$@Model.preco.ToString("F2")</s></sup></h3>
                        <h1 class="mb-4 mt-0">R$@novoPreco.ToString("F2")</h1>
                    }else{
                        <h2 class="my-4">R$@Model.preco.ToString("F2")</h2>
                    }
                    
                    <h4>Cor: @Model.corPrincipal</h4>

                    <div class="my-4">
                        <div>
                            @foreach (var img in Model.img){
                                if(i < 1){
                                    <div class="text-center d-inline-block escolha-cor" style="border: 2px solid #1E90FF;">
                                        <img class="img-fluid" src="~/img/produtos/@img.nomeImagem" >
                                    </div>
                                    i++;
                                }else{
                                    break;
                                }
                            }
                         
                            @foreach(var imgOutrasCores in Model.imgOutrasCores){
                                <div class="text-center d-inline-block escolha-cor" onclick="acessarProduto(@imgOutrasCores.idProduto, @imgOutrasCores.calcadoId)">
                                    <img class="img-fluid" src="~/img/produtos/@imgOutrasCores.nomeImagem" >
                                </div>                               
                            }
                        </div>
                    </div>

                    <div>
                        <h4>Tamanhos:</h4>
                        <div>

                            @foreach(var tamanho in Model.tamanho){
                                if(tamanho.idTamanho == Model.tamanhoId){
                                    <div id="@tamanho.tamanho-tam" class="text-center d-inline-block escolha-tamanho" onclick="acessarProduto(@tamanho.idProduto, @tamanho.calcadoId)" style="border: 1px solid #1E90FF;">
                                        <span>@tamanho.tamanho</span>
                                    </div>
                                }else{
                                    <div id="@tamanho.tamanho-tam" class="text-center d-inline-block escolha-tamanho" onclick="acessarProduto(@tamanho.idProduto, @tamanho.calcadoId)" style="border: 1px solid #000;">
                                        <span>@tamanho.tamanho</span>
                                    </div>
                                }
                                
                            }
                        </div>

                    </div>
                    
                        @if(@Model.isOnCart){
                            <a href="/Catalogo/Carrinho" class="btn btn-dark mt-4 btn-comprar">Ver carrinho</a>
                        }else{
                            decimal promocao = Model.promocao ?? 0;
                            <form method="post" action="/Catalogo/Carrinho">
                                <input type="hidden" name="idProduto" value="@Model.idProduto" />
                                <input type="hidden" name="preco" value="@Model.preco" />
                                <input type="hidden" name="promocao" value="@promocao" />
                                <input type="hidden" name="idProduto" value="@Model.idProduto" />
                                <button class="btn btn-dark mt-4 btn-comprar">Adicionar ao carrinho</button>
                            </form>
                        }
                        
                    
                    
                </div>
            </div>
        </div>


        <hr class="my-5" style="all: unset; display: block; height: 2px; background-color: #000;">


        @if(Model.catalogo.Any()){
        <div>
            <h2 class="text-center">Veja mais dos nossos produtos</h2>
        </div>


        
        <div class="row mt-5 d-none d-md-block">
            <div id="slide-produtos" class="carousel slide" data-bs-interval="false">
                <div class="carousel-inner">
                    @{
                        int j = 0;
                        int total = Model.catalogo.Count;
                        string imgName = "";
                    }

                    @foreach (var catalogo in Model.catalogo)
                    {
                        if (j % 3 == 0)
                        {
                            var activeClass = (j == 0) ? "active" : "";
                            @:<div class="carousel-item @activeClass">
                            @:<div class="row justify-content-center">
                        }

                        <div class="col-3">
                            <div class="items-carousel">
                                <div onclick="acessarProduto(@catalogo.idProduto, @catalogo.calcadoId)">
                                    <div class="text-center img-carousel">
                                        @{
                                            if (catalogo.ApenasImagemPrincipal.Any())
                                            {
                                                imgName = catalogo.ApenasImagemPrincipal.FirstOrDefault();
                                            }
                                            else
                                            {
                                                imgName = "padrao1.png";
                                            }
                                        }
                                        <img height="200px" class="img-fluid" src="~/img/produtos/@imgName" />
                                    </div>

                                    <div class="info-carousel">
                                        <h5>@catalogo.nomeCalcado</h5>

                                        @if (catalogo.promocao > 0)
                                        {
                                            <h4 class="card-title"><s>R$@catalogo.preco.ToString("F2")</s></h4>
                                            var valor = catalogo.preco - catalogo.promocao.Value;
                                            <h3 class="card-subtitle">R$@valor.ToString("F2")</h3>
                                        }
                                        else
                                        {
                                            <h4 class="card-title">R$@catalogo.preco.ToString("F2")</h4>
                                        }

                                        <p>@catalogo.marcaCalcado</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        j++;

                        if (j % 3 == 0 || j == total)
                        {
                            @:</div> 
                            @:</div>
                        }
                    }
                    

                    <button class="carousel-control-prev" type="button" data-bs-target="#slide-produtos" data-bs-slide="prev">
                        <span style="filter:invert(1)" class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>

                    <button class="carousel-control-next" type="button" data-bs-target="#slide-produtos" data-bs-slide="next">
                        <span style="filter:invert(1)" class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>


        <div class="row mt-5 d-block d-md-none">
            <div id="slide-produtos-sm" class="carousel slide" data-bs-interval="false">
                <div class="carousel-inner">
                    @{
                        int j2 = 0;
                        int total2 = Model.catalogo.Count;
                        string imgName2 = "";
                    }

                    @foreach (var catalogo in Model.catalogo)
                    {
                        if (j2 % 1 == 0)
                        {
                            var activeClass = (j2 == 0) ? "active" : "";
                            @:<div class="carousel-item @activeClass">
                            @:<div class="row justify-content-center">
                        }

                        <div class="col-3">
                            <div class="items-carousel">
                                <div onclick="acessarProduto(@catalogo.idProduto, @catalogo.calcadoId)">
                                    <div class="text-center img-carousel">
                                        @{
                                            if (catalogo.ApenasImagemPrincipal.Any())
                                            {
                                                imgName2 = catalogo.ApenasImagemPrincipal.FirstOrDefault();
                                            }
                                            else
                                            {
                                                imgName2 = "padrao1.png";
                                            }
                                        }
                                        <img height="200px" class="img-fluid" src="~/img/produtos/@imgName2" />
                                    </div>

                                    <div class="info-carousel">
                                        <h5>@catalogo.nomeCalcado</h5>

                                        @if (catalogo.promocao > 0)
                                        {
                                            <h4 class="card-title"><s>R$@catalogo.preco.ToString("F2")</s></h4>
                                            var valor = catalogo.preco - catalogo.promocao.Value;
                                            <h3 class="card-subtitle">R$@valor.ToString("F2")</h3>
                                        }
                                        else
                                        {
                                            <h4 class="card-title">R$@catalogo.preco.ToString("F2")</h4>
                                        }

                                        <p>@catalogo.marcaCalcado</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        j++;

                        if (j % 1 == 0 || j == total2)
                        {
                            @:</div> 
                            @:</div>
                        }
                    }
                    

                    <button class="carousel-control-prev" type="button" data-bs-target="#slide-produtos-sm" data-bs-slide="prev">
                        <span style="filter:invert(1)" class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>

                    <button class="carousel-control-next" type="button" data-bs-target="#slide-produtos-sm" data-bs-slide="next">
                        <span style="filter:invert(1)" class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>
    }
    </div>
   

    @await Html.PartialAsync("_Footer")

    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>

<script>

    const container = document.querySelector("#foto-principal-produto");
    const img = container.querySelector("img");

    container.addEventListener("mousemove", (e) => {
        const rect = container.getBoundingClientRect();
        const x = e.clientX - rect.left; 
        const y = e.clientY - rect.top;

        // Define o ponto de origem do zoom
        img.style.transformOrigin = `${x}px ${y}px`;
        img.style.transform = "scale(2.5)";
    });

    container.addEventListener("mouseleave", () => {
        img.style.transform = "scale(1)";
        img.style.transformOrigin = "center center";
    });


    function trocarImgPrincipal(nomeImagem){
        imgPrincipal = document.querySelector("#img-principal");
        imgPrincipal.src = "../../../img/produtos/" + nomeImagem;

        imgEscolhida = document.getElementById(nomeImagem);

        todasImagens = document.querySelectorAll(".foto-secundaria-produto");

        todasImagens.forEach(imagem => {
            imagem.style = "border: 2px solid #000;"
        })

        imgEscolhida.style = "border: 2px solid #1E90FF;"
    }

    function acessarProduto(idProduto, calcadoId) {
        window.location.href = "/Catalogo/Produto/" + idProduto + "/" + calcadoId
    }
</script>